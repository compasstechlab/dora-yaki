services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "7202:7202"
    environment:
      - PORT=7202
      - ENVIRONMENT=development
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - GCP_PROJECT_ID=${GCP_PROJECT_ID}
    volumes:
      # ローカル開発環境専用: ホストのgcloud認証情報をマウント
      # 本番環境ではサービスアカウントを使用すること
      - ~/.config/gcloud:/root/.config/gcloud:ro

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "7201:7201"
    environment:
      - VITE_API_BASE=http://localhost:7202
    depends_on:
      - backend
